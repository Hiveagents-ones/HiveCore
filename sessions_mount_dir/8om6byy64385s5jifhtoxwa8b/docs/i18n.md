# 国际化实现文档

## 概述

本文档描述了项目中国际化(i18n)的实现方案，包括多语言支持、语言切换机制以及翻译文件的管理。

## 技术实现

### 前端实现

前端使用 Vue I18n 实现国际化功能，主要配置如下：

#### 1. 安装依赖

```bash
npm install vue-i18n@9
```

#### 2. 配置文件结构

```
frontend/src/locales/
├── zh.json    # 中文翻译
├── en.json    # 英文翻译
└── index.js   # i18n配置入口
```

#### 3. 初始化配置

```javascript
// frontend/src/locales/index.js
import { createI18n } from 'vue-i18n'
import zh from './zh.json'
import en from './en.json'

const messages = {
  zh,
  en
}

const i18n = createI18n({
  legacy: false,
  locale: 'zh', // 默认语言
  fallbackLocale: 'en',
  messages
})

export default i18n
```

#### 4. 在main.js中引入

```javascript
// frontend/src/main.js
import { createApp } from 'vue'
import App from './App.vue'
import i18n from './locales'

const app = createApp(App)
app.use(i18n)
app.mount('#app')
```

### 翻译文件示例

#### 中文翻译 (zh.json)

```json
{
  "common": {
    "save": "保存",
    "cancel": "取消",
    "delete": "删除",
    "edit": "编辑",
    "add": "新增"
  },
  "member": {
    "title": "会员管理",
    "name": "姓名",
    "phone": "联系方式",
    "cardNumber": "会员卡号",
    "level": "会员等级",
    "remainingHours": "剩余课时",
    "validityPeriod": "有效期"
  }
}
```

#### 英文翻译 (en.json)

```json
{
  "common": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "add": "Add"
  },
  "member": {
    "title": "Member Management",
    "name": "Name",
    "phone": "Contact",
    "cardNumber": "Card Number",
    "level": "Member Level",
    "remainingHours": "Remaining Hours",
    "validityPeriod": "Validity Period"
  }
}
```

### 在组件中使用

```vue
<template>
  <div>
    <h1>{{ $t('member.title') }}</h1>
    <el-button>{{ $t('common.save') }}</el-button>
  </div>
</template>

<script setup>
import { useI18n } from 'vue-i18n'

const { t, locale } = useI18n()

// 切换语言
const switchLanguage = (lang) => {
  locale.value = lang
}
</script>
```

### 语言切换实现

```vue
<template>
  <el-select v-model="currentLanguage" @change="handleLanguageChange">
    <el-option label="中文" value="zh" />
    <el-option label="English" value="en" />
  </el-select>
</template>

<script setup>
import { ref } from 'vue'
import { useI18n } from 'vue-i18n'

const { locale } = useI18n()
const currentLanguage = ref(locale.value)

const handleLanguageChange = (lang) => {
  locale.value = lang
  localStorage.setItem('language', lang)
}
</script>
```

## 后端国际化

### API响应国际化

后端API支持根据请求头Accept-Language返回对应语言的错误信息和提示。

```python
# backend/app/core/i18n.py
from fastapi import Request, Header
from typing import Optional

async def get_language(
    request: Request,
    accept_language: Optional[str] = Header(None)
) -> str:
    """获取请求语言"""
    if accept_language:
        return accept_language.split(',')[0].split('-')[0]
    return 'zh'

# 使用示例
@router.get("/members")
async def get_members(
    language: str = Depends(get_language)
):
    messages = {
        'zh': '获取会员列表成功',
        'en': 'Get member list successfully'
    }
    return {
        "message": messages.get(language, messages['zh']),
        "data": [...]
    }
```

## 最佳实践

1. **翻译键命名规范**：使用模块.功能.描述的层级结构，如`member.title`
2. **避免硬编码**：所有用户可见的文本都应使用翻译
3. **保持一致性**：相同功能的文本在不同页面应使用相同的翻译键
4. **复数处理**：对于需要复数形式的文本，使用Vue I18n的复数语法
5. **日期时间格式**：根据不同语言显示合适的日期时间格式

## 扩展计划

1. 支持更多语言（如日语、韩语等）
2. 实现翻译文件的动态加载
3. 添加翻译管理后台
4. 支持RTL（从右到左）语言
5. 集成专业翻译服务API

## 注意事项

1. 翻译文件应保持UTF-8编码
2. 修改翻译文件后需要重新构建前端项目
3. 新增功能时需要同步更新所有语言的翻译文件
4. 定期检查翻译的准确性和一致性